import{d as E,c as F,e as O,a as I,u as q,f as z,r as m,g as x,h as A,t as p,j as t}from"./main-deOYDPWY.js";import{u as L,a as _,b as Q,C as K,T as R,c as $}from"./useDebounce-BsBQ78x4.js";import{u as V,C as G}from"./CustomTextInput-CVvPr6Oa.js";import{B as r}from"./button-CaKppYKQ.js";import{B as H}from"./badge-DcPkLrDx.js";import{E as J}from"./eye-DEYj2jSP.js";import{S as U}from"./square-pen-6FTiLTda.js";import"./index-B3fMHV4j.js";const W=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],X=E("plus",W),Y=I("9fb36a3bc07db7f995bfaf430ef6864612da15a3b35e379d7deb968238d76812"),Z=F({method:"POST"}).middleware([O]).handler(Y);function ce(){const i=q(),g=z(),[h,C]=m.useState(""),o=L(h,500),[s,c]=m.useState({total:0,limit:5,offset:0,hasMore:!1}),{dialogState:a,openDialog:y,closeDialog:d,handleConfirm:v}=_(),N=x(A),j=x(Z),{data:u,isLoading:P,error:f,refetch:S}=Q({queryKey:["patients",s.limit,s.offset,o],queryFn:()=>N({data:{limit:s.limit,offset:s.offset,name:o||void 0}}),staleTime:3e4});m.useEffect(()=>{c(e=>({...e,offset:0}))},[o]);const l=V({mutationFn:e=>j({data:{id:e}}),onSuccess:()=>{g.invalidateQueries({queryKey:["patients"]}),p.success("Patient deleted successfully"),d()},onError:e=>{p.error("Error deleting patient: "+e.message),d()}}),T=e=>{C(e)},b=e=>{c(n=>({...n,offset:e}))},D=e=>{c(n=>({...n,limit:e,offset:0}))},k=e=>{y({title:"Delete Patient",description:"Are you sure you want to delete this patient? This action cannot be undone.",id:e,confirmText:"Delete",cancelText:"Cancel",variant:"destructive",onConfirm:n=>{l.mutate(n)}})},w=u?.patients||[],B=u?.pagination||s,M=[{key:"name",header:"Name",headerClassName:"text-center",accessor:"name",className:"font-medium"},{key:"email",header:"Email",headerClassName:"text-center",render:e=>e.email||"-"},{key:"phone",header:"Phone",headerClassName:"text-center",render:e=>e.phone||"-"},{key:"dateOfBirth",header:"Date of Birth",headerClassName:"text-center",render:e=>e.dateOfBirth?new Date(e.dateOfBirth).toLocaleDateString():"-"},{key:"orders",header:"Orders",headerClassName:"text-center",render:e=>t.jsxs(H,{variant:"secondary",children:[e._count.orders," orders"]}),className:"text-center"},{key:"createdAt",header:"Created",headerClassName:"text-center",render:e=>new Date(e.createdAt).toLocaleDateString(),className:"text-muted-foreground text-sm"}];return f?t.jsx("div",{className:"container mx-auto py-8",children:t.jsxs("div",{className:"text-center text-red-500",children:["Error loading patients: ",f.message,t.jsx("br",{}),t.jsx(r,{onClick:()=>S(),className:"mt-4",children:"Try Again"})]})}):t.jsxs("div",{className:"container mx-auto py-4 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Patients"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage patient information and records"})]}),t.jsxs(r,{onClick:()=>i({to:"/patients/new"}),children:[t.jsx(X,{className:"h-4 w-4 mr-2"}),"Add Patient"]})]}),t.jsx("div",{className:"flex items-center space-x-2",children:t.jsx("div",{className:"flex-1 max-w-sm",children:t.jsx(G,{field:{name:"search",state:{value:h,meta:{errors:[],isTouched:!1,isBlurred:!1,isDirty:!1,errorMap:{},errorSourceMap:{},isValidating:!1}},handleChange:T,handleBlur:()=>{}},placeholder:"Search patients by name..."})})}),t.jsx(K,{data:w,columns:M,pagination:B,onPageChange:b,onPageSizeChange:D,loading:P,emptyMessage:"No patients found",actions:e=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(r,{variant:"outline",size:"sm",onClick:()=>i({to:"/patients/$patientId",params:{patientId:e.id}}),children:t.jsx(J,{className:"h-4 w-4"})}),t.jsx(r,{variant:"outline",size:"sm",onClick:()=>i({to:"/patients/$patientId/edit",params:{patientId:e.id}}),children:t.jsx(U,{className:"h-4 w-4"})}),t.jsx(r,{variant:"outline",size:"sm",onClick:()=>k(e.id),className:"text-destructive hover:text-destructive",disabled:l.isPending,children:t.jsx(R,{className:"h-4 w-4"})})]})}),t.jsx($,{isOpen:a.isOpen,onClose:d,onConfirm:v,title:a.title,description:a.description,confirmText:a.confirmText,cancelText:a.cancelText,id:a.id,variant:a.variant,isLoading:l.isPending})]})}export{ce as component};
